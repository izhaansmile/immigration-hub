<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Immigration Resource Hub</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Immigration Resource Hub</h1>
    <p>Support and updates for immigrants, updated live.</p>
  </header>


    <section>
      <h2>ðŸ“¢ Latest Immigration News</h2>
      <div id="feed"></div>

      <script>
        // check if the text is mostly English
        function isMostlyEnglish(text) {
        const englishWords = ['the', 'and', 'you', 'that', 'was', 'for', 'with', 'have', 'this', 'but'];
        text = text.toLowerCase();

        // Check if text contains mostly English letters (A-Z, a-z, space)
        const englishChars = text.match(/[a-z\s]/g) || [];
        const ratio = englishChars.length / text.length;
        if (ratio < 0.7) return false; // Less than 70% English letters

        // Check if contains at least one common English word
        return englishWords.some(word => text.includes(word));
      }
        
        async function loadRSS() {
          const response = await fetch('https://api.rss2json.com/v1/api.json?rss_url=https://documentedny.com/feed/');
          const data = await response.json();
          const container = document.getElementById("feed");
          const filtered = data.items.filter(item => {
          const content = (item.title + " " + item.description).toLowerCase();
          return isMostlyEnglish(content);
          });

          if (filtered.length === 0) {
          container.innerHTML = "<p>No English articles found.</p>";
          return;
          }

          filtered.forEach(item => {
          const div = document.createElement("div");
          div.innerHTML = `
            <h3><a href="${item.link}" target="_blank" rel="noopener">${item.title}</a></h3>
            <p>${item.description}</p>
            <hr>
          `;
          container.appendChild(div);
          });

          data.items.slice(0, 20).forEach(item => {
            const card = document.createElement("div");
            card.className = "feed-item";
            card.innerHTML = `
              <a href="${item.link}" target="_blank">${item.title}</a>
              <time>${new Date(item.pubDate).toLocaleDateString()}</time>
              <p>${item.description.slice(0, 150)}...</p>
            `;
            container.appendChild(card);
          });
        }

        loadRSS();
      </script>
    </section>

  <footer>
    <p>Last updated: July 2025 â€¢ Built for community use</p>
  </footer
</body>
</html>